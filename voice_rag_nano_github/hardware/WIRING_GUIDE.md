# 🔌 ESP32-S3 Nano 하드웨어 연결 가이드

## 📦 필요 부품

| 부품 | 수량 | 설명 |
|------|------|------|
| ESP32-S3 Nano | 1 | 메인 컨트롤러 (PSRAM 포함) |
| GC9A01 1.28" LCD | 1 | 240x240 원형 디스플레이 |
| INMP441 | 1 | I2S 디지털 마이크 |
| MAX98357A | 1 | I2S 오디오 앰프 |
| 스피커 | 1 | 3W 4Ω 또는 8Ω |
| 점퍼 와이어 | ~15개 | 연결용 |

---

## 📌 ESP32-S3 Nano 핀아웃

```
         ┌──────────────────────┐
         │     ESP32-S3 Nano    │
         │      (Top View)      │
         │                      │
    3.3V │●                    ●│ 5V (VBUS)
     GND │●                    ●│ GND
   GPIO1 │●                    ●│ GPIO2
   GPIO3 │●                    ●│ GPIO4  ← MIC SCK
   GPIO5 │●                    ●│ GPIO6  ← MIC SD
   GPIO7 │●                    ●│ GPIO8
   GPIO9 │●                    ●│ GPIO10 ← LCD CS
  GPIO11 │●                    ●│ GPIO12 ← LCD SCL
  GPIO13 │●                    ●│ GPIO14 ← LCD RST
  GPIO15 │●     [USB-C]        ●│ GPIO16 ← SPK DIN
  GPIO17 │●                    ●│ GPIO18
  GPIO21 │●                    ●│ GPIO35
  GPIO36 │●                    ●│ GPIO37
  GPIO38 │●                    ●│ GPIO39
  GPIO40 │●                    ●│ GPIO41
  GPIO42 │●                    ●│ GPIO47
  GPIO48 │●                    ●│ GPIO0 (BOOT)
         │                      │
         └──────────────────────┘
```

---

## 🎤 INMP441 마이크 연결

```
INMP441          ESP32-S3 Nano
┌───────┐        
│  VDD  │───────→ 3.3V
│  GND  │───────→ GND
│  SD   │───────→ GPIO6  (데이터)
│  SCK  │───────→ GPIO4  (클럭)
│  WS   │───────→ GPIO5  (워드셀렉트)
│  L/R  │───────→ GND    (왼쪽채널)
└───────┘

⚠️ 주의: VDD는 반드시 3.3V! (5V 연결 시 손상)
```

### 연결 다이어그램
```
                    ┌─────────────┐
                    │   INMP441   │
                    │   ┌─────┐   │
                    │   │ MIC │   │
                    │   │  ◉  │   │
                    │   └─────┘   │
                    │             │
          3.3V ────→│ VDD        │
           GND ────→│ GND        │
        GPIO6  ←────│ SD         │
        GPIO4  ────→│ SCK        │
        GPIO5  ────→│ WS         │
           GND ────→│ L/R        │
                    └─────────────┘
```

---

## 🔊 MAX98357A 스피커 앰프 연결

```
MAX98357A        ESP32-S3 Nano
┌───────┐        
│  VIN  │───────→ 5V (VBUS)
│  GND  │───────→ GND
│  DIN  │───────→ GPIO16 (데이터)
│  BCLK │───────→ GPIO7  (비트클럭)
│  LRC  │───────→ GPIO15 (좌우클럭)
│  GAIN │        (연결 안함 = 9dB)
│  SD   │        (연결 안함 = 켜짐)
│       │
│  +    │───────→ 스피커 +
│  -    │───────→ 스피커 -
└───────┘
```

### GAIN 설정
| GAIN 핀 | 게인 |
|---------|------|
| 연결 안함 | 9dB (기본, 권장) |
| GND | 6dB |
| 3.3V | 15dB |

---

## 📺 GC9A01 LCD 연결

```
GC9A01           ESP32-S3 Nano
┌───────┐        
│  VCC  │───────→ 3.3V
│  GND  │───────→ GND
│  SCL  │───────→ GPIO12 (SPI 클럭)
│  SDA  │───────→ GPIO11 (SPI 데이터)
│  CS   │───────→ GPIO10 (칩 선택)
│  DC   │───────→ GPIO13 (데이터/명령)
│  RST  │───────→ GPIO14 (리셋)
│  BL   │───────→ 3.3V 또는 GPIO21
└───────┘

BL (백라이트): 
- 3.3V 직접 연결 = 항상 최대 밝기
- GPIO 연결 = 밝기 조절 가능 (PWM)
```

---

## 📊 전체 연결 요약표

| 모듈 | 모듈 핀 | ESP32 핀 | 설명 |
|------|---------|----------|------|
| **전원** | | | |
| 공통 | VCC/VDD | 3.3V | LCD, 마이크 전원 |
| MAX98357A | VIN | 5V (VBUS) | 앰프 전원 |
| 공통 | GND | GND | 접지 |
| **INMP441** | | | |
| 마이크 | SD | GPIO6 | 데이터 출력 |
| 마이크 | SCK | GPIO4 | 비트 클럭 |
| 마이크 | WS | GPIO5 | 워드 선택 |
| 마이크 | L/R | GND | 채널 선택 |
| **MAX98357A** | | | |
| 앰프 | DIN | GPIO16 | 데이터 입력 |
| 앰프 | BCLK | GPIO7 | 비트 클럭 |
| 앰프 | LRC | GPIO15 | 좌우 클럭 |
| **GC9A01** | | | |
| LCD | SCL | GPIO12 | SPI 클럭 |
| LCD | SDA | GPIO11 | SPI 데이터 |
| LCD | CS | GPIO10 | 칩 선택 |
| LCD | DC | GPIO13 | 데이터/명령 |
| LCD | RST | GPIO14 | 리셋 |
| LCD | BL | 3.3V/GPIO21 | 백라이트 |
| **버튼** | | | |
| 내장 | BOOT | GPIO0 | 녹음 버튼 |

---

## ⚡ 전원 연결

### USB 전원 (권장)
```
USB-C 케이블 → ESP32-S3 Nano USB 포트
               ↓
         내부 레귤레이터
         ↓          ↓
       5V(VBUS)   3.3V
         ↓          ↓
    MAX98357A   나머지 모듈
```

### 외부 배터리 사용 시
```
3.7V LiPo 배터리
      ↓
TP4056 충전 모듈 + MT3608 부스터
      ↓
     5V → ESP32-S3 Nano VIN
```

---

## 🔧 조립 순서

### Step 1: 전원 연결
```
1. ESP32 Nano의 3.3V → 브레드보드 전원 레일
2. ESP32 Nano의 5V  → 브레드보드 전원 레일 (별도)
3. ESP32 Nano의 GND → 브레드보드 GND 레일
```

### Step 2: LCD 연결
```
1. VCC → 3.3V 레일
2. GND → GND 레일
3. SCL → GPIO12
4. SDA → GPIO11
5. CS  → GPIO10
6. DC  → GPIO13
7. RST → GPIO14
8. BL  → 3.3V (또는 GPIO21)

테스트: Arduino 예제 업로드하여 화면 확인
```

### Step 3: 마이크 연결
```
1. VDD → 3.3V 레일
2. GND → GND 레일
3. SD  → GPIO6
4. SCK → GPIO4
5. WS  → GPIO5
6. L/R → GND

테스트: 시리얼 모니터에서 마이크 값 확인
```

### Step 4: 스피커 연결
```
1. VIN  → 5V 레일
2. GND  → GND 레일
3. DIN  → GPIO16
4. BCLK → GPIO7
5. LRC  → GPIO15
6. 스피커 + → 앰프 +
7. 스피커 - → 앰프 -

테스트: 톤 재생 테스트
```

---

## ❓ 문제 해결

### LCD가 안 켜져요
- [ ] VCC가 3.3V에 연결되었나요?
- [ ] TFT_eSPI User_Setup.h 설정했나요?
- [ ] 핀 번호가 맞나요?

### 마이크가 안 돼요
- [ ] VDD가 3.3V인가요? (5V 아님!)
- [ ] L/R 핀이 GND에 연결되었나요?
- [ ] 시리얼 모니터에서 값이 나오나요?

### 스피커에서 소리가 안 나요
- [ ] VIN이 5V에 연결되었나요?
- [ ] 스피커 +/- 가 맞나요?
- [ ] GAIN, SD 핀은 연결 안 해도 됩니다

### 잡음이 심해요
- [ ] 전선을 최대한 짧게 사용하세요
- [ ] 전원선과 신호선을 분리하세요
- [ ] GND를 한 점에서 연결하세요

---

## 📸 완성 사진 참고

```
        ┌─────────────────────┐
        │    ○ ○ ○ ○ ○       │  ← INMP441 마이크
        │    GC9A01 LCD       │
        │    ┌─────────┐      │
        │    │  12:00  │      │
        │    │  Ready  │      │
        │    └─────────┘      │
        │                     │
        │  [ESP32-S3 Nano]    │
        │                     │
        │    ┌─────────┐      │
        │    │MAX98357A│──🔊  │  ← 스피커
        │    └─────────┘      │
        └─────────────────────┘
```
